Computerkonto aktiv?
Get-ADComputer -server SVHD-DC34.edu.srh.de -Filter {(Name -like "SHSDAKLREIL*") -and (Enabled -eq $True)} -Properties whenChanged
Get-ADComputer -server SVHD-DC12.srhk.srh.de -Filter {(Name -like "BBWND0404230*") -and (Enabled -eq $True)}

Get-ADComputer -server SVHD-DC12.srhk.srh.de -SearchBase "OU=_Haus12,OU=SHS,OU=Rechner,OU=SRHSchulenGmbH,OU=_Schulen,OU=Clients,OU=Tier2,OU=SRHK,DC=srhk,DC=srh,DC=de" -Filter {(Enabled -eq $False)} | export-csv .\Documents\SRHK-Clients_Haus6_deaktiviert.csv
(Get-ADComputer -server SVHD-DC12.srhk.srh.de -SearchBase "OU=_Haus12,OU=SHS,OU=Rechner,OU=SRHSchulenGmbH,OU=_Schulen,OU=Clients,OU=Tier2,OU=SRHK,DC=srhk,DC=srh,DC=de" -Filter {(Enabled -eq $False)}).count
06.12.2021	22
07.12.2021	17
10.12.2021	16
20.12.2021	13
27.12.2021	12



Get-ADComputer -server SVHD-DC12.srhk.srh.de -Filter {(Name -like "BBWN1-38MFN73") -or (Name -like "BBWN1-5x60p73") -or (Name -like "BBWN1-jjbpn73") -or (Name -like "BBWN1-F56r8d3")}
Get-ADComputer -server SVHD-DC12.srhk.srh.de -Filter {(Name -eq "SHSD08061201")}

Get-ADUser -server SVHD-DC34.edu.srh.de -filter {(Name -like "Ries, F*")}
Get-ADUser -server SVHD-DC34.edu.srh.de -filter {(Name -like "Ries, F*")} -properties Name, mail, distinguishedname | select Name, mail, distinguishedname | export-csv .\documents\BBWN-Mitarbeiter.csv


Set-ADUser -server SVHD-DC34.edu.srh.de boehmde -enabled $true


test-connection svngd072.srhk.srh.de

+++ User Passwort zurücksetzen +++

Set-ADAccountPassword schwabann -server SVHD-DC12.srhk.srh.de  -NewPassword $NewPwd -Reset -PassThru | Set-ADuser -ChangePasswordAtLogon $True
Set-ADAccountPassword juchlers -server SVHD-DC34.edu.srh.de  -NewPassword $NewPwd -Reset -PassThru | Set-ADuser -ChangePasswordAtLogon $True

Get-ADUser -Filter {sAMAccountName -like "*"} | Set-ADAccountPassword -Reset -NewPassword (ConvertTo-SecureString -AsPlainText "Password123" -Force)

Get-ADUser -server SVHD-DC12.srhk.srh.de -Filter * -SearchBase "OU=AI_Teilnehmer,OU=Benutzer,OU=BBWNeckargemuend,OU=_Reha,DC=srhk,DC=srh,DC=de" | Set-ADAccountPassword -server SVHD-DC12.srhk.srh.de -Reset -NewPassword (ConvertTo-SecureString -AsPlainText "Willkommen!" -Force)
Get-ADUser -server SVHD-DC12.srhk.srh.de -Filter * -SearchBase "OU=AI_Teilnehmer,OU=Benutzer,OU=BBWNeckargemuend,OU=_Reha,DC=srhk,DC=srh,DC=de" | Set-ADuser -ChangePasswordAtLogon $True

Get-ADUser -server SVHD-DC12.srhk.srh.de -Filter * -SearchBase "OU=5.6 FS,OU=Schueler,OU=SHS,OU=Benutzer,OU=SRHSchulenGmbH,OU=_Schulen,DC=srhk,DC=srh,DC=de" | Set-ADAccountPassword -server SVHD-DC12.srhk.srh.de -Reset -NewPassword (ConvertTo-SecureString -AsPlainText "Willkommen!" -Force)
Get-ADUser -server SVHD-DC12.srhk.srh.de -Filter * -SearchBase "OU=5.6 FS,OU=Schueler,OU=SHS,OU=Benutzer,OU=SRHSchulenGmbH,OU=_Schulen,DC=srhk,DC=srh,DC=de" | Set-ADuser -ChangePasswordAtLogon $True












SRHK

+++ Ablaufdatum Teilnehmer auslesen +++
Get-ADUser -server SVHD-DC12.srhk.srh.de -Filter * -SearchBase "OU=Viernheim,OU=AI_Teilnehmer_AAD,OU=Benutzer,OU=BBWNeckargemuend,OU=_Reha,DC=srhk,DC=srh,DC=de" -properties AccountExpirationDate, enabled, Lastlogontimestamp | Select Name, SamAccountName, AccountExpirationDate, enabled, @{N='LastLogonTimestamp'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} | export-csv .\Documents\TN-Liste_Viernheim.csv
Get-ADUser -server SVHD-DC12.srhk.srh.de -Filter {(Enabled -eq $False)} -SearchBase "OU=AI_Teilnehmer,OU=Benutzer,OU=BBWNeckargemuend,OU=_Reha,DC=srhk,DC=srh,DC=de"
Get-ADUser -server SVHD-DC12.srhk.srh.de -Filter {(Enabled -eq $False)} -SearchBase "OU=VLS,OU=Benutzer,OU=SRHSchulenGmbH,OU=_Schulen,DC=srhk,DC=srh,DC=de"

+++ Schüler auslesen +++
Get-ADUser -server SVHD-DC12.srhk.srh.de -Filter * -SearchBase "OU=Schueler,OU=SHS,OU=Benutzer,OU=SRHSchulenGmbH,OU=_Schulen,DC=srhk,DC=srh,DC=de" -properties Name, mail, SamAccountName | select Name, mail, SamAccountName | export-csv .\documents\Schueler.csv


EDU

+++ Benutzer auslesen +++
Get-ADUser -server SVHD-DC34.edu.srh.de -filter *
Get-ADUser -server SVHD-DC34.edu.srh.de -filter {(Name -like "böhm, de*")}
Get-ADUser -server SVHD-DC34.edu.srh.de -Filter {(Enabled -eq $True)} -SearchBase "OU=03_AussenWohnGruppen,OU=11_Internat,OU=Mitarbeiter,OU=Benutzer,OU=BBWNeckargemuend,OU=_Reha,DC=edu,DC=srh,DC=de" -properties Name, mail, distinguishedname | select Name, mail, distinguishedname | export-csv .\documents\BBWN-Mitarbeiter_AWG.csv
Get-ADUser -server SVHD-DC34.edu.srh.de -Filter {(Enabled -eq $True)} -SearchBase "OU=Jugendhilfe,OU=Mitarbeiter,OU=Benutzer,OU=SRHSchulenGmbH,OU=_Schulen,DC=edu,DC=srh,DC=de" -properties Name, mail, distinguishedname | select Name, mail, distinguishedname | export-csv .\documents\Jugendhilfe.csv










Roland
Alle Rechner der SRH Schulen mit Zeitstempel der letzten Anmeldung eines Benutzers:

Get-ADComputer -server SVHD-DC34.edu.srh.de -Filter * -SearchBase "OU=Rechner,OU=SRHSchulenGmbH,OU=_Schulen,OU=Clients,OU=Tier2,OU=SRH,DC=edu,DC=srh,DC=de" -properties distinguishedname, Lastlogontimestamp | select distinguishedname, @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} 
Get-ADComputer -server SVHD-DC34.edu.srh.de -Filter * -SearchBase "OU=Rechner,OU=SRHSchulenGmbH,OU=_Schulen,OU=Clients,OU=Tier2,OU=SRH,DC=edu,DC=srh,DC=de" -properties distinguishedname, Lastlogontimestamp | select distinguishedname, @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} >.\documents\SchulenrechnerGesamt29.10.21.txt

Alle aktiven bzw deaktivierten Rechner der SRH Schulen mit Zeitstempel der letzten Anmeldung eines Benutzers mit Ausgabe in Datei:

Get-ADComputer -server SVHD-DC34.edu.srh.de -Filter {(Enabled -eq $True)} -SearchBase "OU=Rechner,OU=SRHSchulenGmbH,OU=_Schulen,OU=Clients,OU=Tier2,OU=SRH,DC=edu,DC=srh,DC=de" -properties distinguishedname, Lastlogontimestamp | select distinguishedname, @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} >.\documents\SchulenrechnerAktiven29.10.21.txt
Get-ADComputer -server SVHD-DC34.edu.srh.de -Filter {(Enabled -eq $False)} -SearchBase "OU=Rechner,OU=SRHSchulenGmbH,OU=_Schulen,OU=Clients,OU=Tier2,OU=SRH,DC=edu,DC=srh,DC=de" -properties distinguishedname, Lastlogontimestamp | select distinguishedname, @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} >.\documents\SchulenrechnerDeaktiviert29.10.21.txt


Alle Rechner des BBWN mit Zeitstempel der letzten Anmeldung eines Benutzers:

Get-ADComputer -server SVHD-DC34.edu.srh.de -Filter * -SearchBase "OU=Rechner,OU=BBWNeckargemuend,OU=_Reha,OU=Clients,OU=Tier2,OU=SRH,DC=edu,DC=srh,DC=de" -properties distinguishedname, Lastlogontimestamp | select distinguishedname, @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} 
Get-ADComputer -server SVHD-DC34.edu.srh.de -Filter * -SearchBase "OU=Rechner,OU=BBWNeckargemuend,OU=_Reha,OU=Clients,OU=Tier2,OU=SRH,DC=edu,DC=srh,DC=de" -properties distinguishedname, Lastlogontimestamp | select distinguishedname, @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} >.\documents\BBWNRechnerGesamt29.10.21.txt

Alle aktiven bzw deaktivierten Rechner des BBWN mit Zeitstempel der letzten Anmeldung eines Benutzers mit Ausgabe in Datei:

Get-ADComputer -server SVHD-DC34.edu.srh.de -Filter {(Enabled -eq $True)} -SearchBase "OU=Rechner,OU=BBWNeckargemuend,OU=_Reha,OU=Clients,OU=Tier2,OU=SRH,DC=edu,DC=srh,DC=de" -properties distinguishedname, Lastlogontimestamp | select distinguishedname, @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} >.\documents\BBWNRechnerAktiven29.10.21.txt
Get-ADComputer -server SVHD-DC34.edu.srh.de -Filter {(Enabled -eq $False)} -SearchBase "OU=Rechner,OU=BBWNeckargemuend,OU=_Reha,OU=Clients,OU=Tier2,OU=SRH,DC=edu,DC=srh,DC=de" -properties cn, distinguishedname, Lastlogontimestamp | select cn, distinguishedname, @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} |export-csv .\Documents\BBWNRechner_deaktiviert.csv
Anzahl
(Get-ADComputer -server SVHD-DC34.edu.srh.de -Filter {(Enabled -eq $False)} -SearchBase "OU=Rechner,OU=BBWNeckargemuend,OU=_Reha,OU=Clients,OU=Tier2,OU=SRH,DC=edu,DC=srh,DC=de" -properties cn, distinguishedname, Lastlogontimestamp | select cn, distinguishedname, @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}}).count


Alle Mitarbeiter-Benutzerkonten mit PWDlastSet und lastlogontimestamp der SRHS oder des BBWN

Get-ADUser -server SVHD-DC34.edu.srh.de -Filter * -SearchBase "OU=Mitarbeiter,OU=Benutzer,OU=SRHSchulenGmbH,OU=_Schulen,DC=edu,DC=srh,DC=de" -properties distinguishedname, pwdlastset, Lastlogontimestamp | select distinguishedname,  @{N='pwdlastset'; E={[DateTime]::FromFileTime($_.PwdLastSet)}}  , @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} >.\documents\SRHSmitarbeiterGesamt29.10.21.txt
Get-ADUser -server SVHD-DC34.edu.srh.de -Filter * -SearchBase "OU=Mitarbeiter,OU=Benutzer,OU=BBWNeckargemuend,OU=_Reha,DC=edu,DC=srh,DC=de" -properties distinguishedname, pwdlastset, Lastlogontimestamp | select distinguishedname,  @{N='pwdlastset'; E={[DateTime]::FromFileTime($_.PwdLastSet)}}  , @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} >.\documents\BBWNmitarbeiterGesamt29.10.21.txt


Alle aktiven EDU-Rechner:

Get-ADComputer -server SVHD-DC34.edu.srh.de -Filter {(Enabled -eq $True)} -SearchBase "OU=Clients,OU=Tier2,OU=SRH,DC=edu,DC=srh,DC=de" -properties name, distinguishedname, Lastlogontimestamp | select name, @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} >.\documents\EDURechnerAktiv29.10.21.txt




Get-ADUser -server SVHD-DC34.edu.srh.de -Filter * -SearchBase "OU=Mitarbeiter,OU=Benutzer,OU=SRHSchulenGmbH,OU=_Schulen,DC=edu,DC=srh,DC=de" -properties distinguishedname, pwdlastset, Lastlogontimestamp | select distinguishedname,  @{N='pwdlastset'; E={[DateTime]::FromFileTime($_.PwdLastSet)}}  , @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} >.\documents\SRHSmitarbeiterGesamt29.10.21.txt
Get-ADUser -server SVHD-DC34.edu.srh.de -Filter * -SearchBase "OU=Mitarbeiter,OU=Benutzer,OU=BBWNeckargemuend,OU=_Reha,DC=edu,DC=srh,DC=de" -properties distinguishedname, pwdlastset, Lastlogontimestamp | select distinguishedname,  @{N='pwdlastset'; E={[DateTime]::FromFileTime($_.PwdLastSet)}}  , @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} >.\documents\BBWNmitarbeiterGesamt29.10.21.txt

Get-ADComputer -server SVHD-DC34.edu.srh.de -Filter * -SearchBase "OU=Rechner,OU=BBWNeckargemuend,OU=_Reha,OU=Clients,OU=Tier2,OU=SRH,DC=edu,DC=srh,DC=de" -properties name, distinguishedname, Lastlogontimestamp | select name, distinguishedname, @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} >.\documents\BBWNRechnerGesamt29.10.21.txt
Get-ADComputer -server SVHD-DC34.edu.srh.de -Filter {(Enabled -eq $True)} -SearchBase "OU=Rechner,OU=BBWNeckargemuend,OU=_Reha,OU=Clients,OU=Tier2,OU=SRH,DC=edu,DC=srh,DC=de" -properties name, distinguishedname, Lastlogontimestamp | select name, distinguishedname, @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} >.\documents\BBWNRechnerAktiven29.10.21.txt


Get-ADComputer -server SVHD-DC34.edu.srh.de -Filter * -SearchBase "OU=Rechner,OU=SRHSchulenGmbH,OU=_Schulen,OU=Clients,OU=Tier2,OU=SRH,DC=edu,DC=srh,DC=de" -properties name, distinguishedname, Lastlogontimestamp | select name, distinguishedname, @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} >.\documents\SchulenrechnerGesamt29.10.21.txt
Get-ADComputer -server SVHD-DC34.edu.srh.de -Filter {(Enabled -eq $True)} -SearchBase "OU=Rechner,OU=SRHSchulenGmbH,OU=_Schulen,OU=Clients,OU=Tier2,OU=SRH,DC=edu,DC=srh,DC=de" -properties name, distinguishedname, Lastlogontimestamp | select name, distinguishedname, @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} >.\documents\SchulenrechnerAktiven29.10.21.txt

Get-ADComputer -server SVHD-DC34.edu.srh.de -Filter {(Enabled -eq $True)} -SearchBase "OU=Clients,OU=Tier2,OU=SRH,DC=edu,DC=srh,DC=de" -properties name, distinguishedname, Lastlogontimestamp | select name, @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} >.\documents\EDURechnerAktiv29.10.21.txt
Get-ADComputer -server SVHD-DC34.edu.srh.de -Filter * -SearchBase "OU=Clients,OU=Tier2,OU=SRH,DC=edu,DC=srh,DC=de" -properties name, enabled, distinguishedname, Lastlogontimestamp | select name, enabled, @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}}, distinguishedname >.\documents\EDURechnergesamt3O.10.21.txt


Get-ADUser -server SVHD-DC34.edu.srh.de -Filter * -SearchBase "OU=Postfaecher,OU=Benutzer,OU=SRHSchulenGmbH,OU=_Schulen,DC=edu,DC=srh,DC=de" -properties distinguishedname, name, MSExchDelegateListLink| select distinguishedname,  name , MSExchangeDelegateListLink >.\documents\SRHSPostfaecher01.12.21.txt

Get-ADUser -server SVHD-DC34.edu.srh.de -Filter * -SearchBase "OU=Heidelberg,OU=_Hochschulen,DC=edu,DC=srh,DC=de" -properties name, homeDirectory | select   name , homeDirectory |export-csv .\documents\HSHDHomedirectoryV2_01.12.21.csv


REport SSRH-Konzern:
Get-ADComputer -server SVHD-DC05.srh.de -Filter * -SearchBase "OU=Clients,OU=Tier2,OU=SRH,DC=srh,DC=de" -properties name, enabled, distinguishedname, Lastlogontimestamp | select name, enabled, @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}}, distinguishedname |export-csv .\documents\SRHRechnergesamt01.12.21.csv

Get-ADComputer -server SVHD-DC21.kliniken.srh.de -Filter * -SearchBase "DC=Kliniken,DC=srh,DC=de" -properties name, enabled, distinguishedname, Lastlogontimestamp | select name, enabled, @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}}, distinguishedname |export-csv .\documents\KlinikenRechnergesamt01.12.21.csv



Tägliches Monitoring ab 1.11.2021

Get-ADComputer -server SVHD-DC34.edu.srh.de -Filter * -SearchBase "OU=Clients,OU=Tier2,OU=SRH,DC=edu,DC=srh,DC=de" -properties name, enabled, distinguishedname, Lastlogontimestamp | select name, enabled, @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}}, distinguishedname |export-csv .\documents\EDURechnergesamt01.12.21.csv
Get-ADUser -server SVHD-DC34.edu.srh.de -Filter {(Enabled -eq $True)} -SearchBase "OU=Mitarbeiter,OU=Benutzer,OU=BBWNeckargemuend,OU=_Reha,DC=edu,DC=srh,DC=de"  -properties distinguishedname, pwdlastset, Lastlogontimestamp | select distinguishedname,  @{N='pwdlastset'; E={[DateTime]::FromFileTime($_.PwdLastSet)}}  , @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} |export-csv .\documents\BBWNMitarbeiterGesamt01.12.21.csv
Get-ADUser -server SVHD-DC34.edu.srh.de -Filter {(Enabled -eq $True)} -SearchBase "OU=Mitarbeiter,OU=Benutzer,OU=SRHSchulenGmbH,OU=_Schulen,DC=edu,DC=srh,DC=de" -properties distinguishedname, pwdlastset, Lastlogontimestamp | select distinguishedname,  @{N='pwdlastset'; E={[DateTime]::FromFileTime($_.PwdLastSet)}}  , @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} |export-csv .\documents\SRHSMitarbeiterGesamt01.12.21.csv

Get-ADComputer -server SVHD-DC12.srhk.srh.de -Filter * -SearchBase "OU=Clients,OU=Tier2,OU=SRHK,DC=srhk,DC=srh,DC=de" -properties name, enabled, distinguishedname, Lastlogontimestamp | select name, enabled, @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}}, distinguishedname |export-csv .\documents\SRHKRechnergesamt01.12.21.csv
Get-ADUser -server SVHD-DC12.srhk.srh.de -Filter {(Enabled -eq $True)} -SearchBase "OU=Benutzer,OU=BBWNeckargemuend,OU=_Reha,DC=srhk,DC=srh,DC=de"  -properties distinguishedname, pwdlastset, Lastlogontimestamp | select distinguishedname,  @{N='pwdlastset'; E={[DateTime]::FromFileTime($_.PwdLastSet)}}  , @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} |export-csv .\documents\BBWNTeilnehmerGesamt01.12.21.csv
Get-ADUser -server SVHD-DC12.srhk.srh.de -Filter {(Enabled -eq $True)} -SearchBase "OU=Benutzer,OU=SRHSchulenGmbH,OU=_Schulen,DC=srhk,DC=srh,DC=de" -properties distinguishedname, pwdlastset, Lastlogontimestamp | select distinguishedname,  @{N='pwdlastset'; E={[DateTime]::FromFileTime($_.PwdLastSet)}}  , @{N='LastLogonTS'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} |export-csv .\documents\SRHKSchuelerGesamt01.12.21.csv



Get-ADUser -server SVHD-DC34.edu.srh.de -Filter * -SearchBase "DC=edu,DC=srh,DC=de"  -properties GivenName, sn, name, SamAccountName, UserPrincipalname, mail, displayname, distinguishedname, enabled, Lastlogontimestamp | select  GivenName, sn, name, SamAccountName, UserPrincipalname, mail, displayname, enabled, distinguishedname , @{N='LastLogonTimestamp'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}}|export-csv .\documents\EDUGesamt01.12.21.csv
Get-ADUser -server SVGRADC04.srh.de -Filter * -SearchBase "DC=srh,DC=de"  -properties GivenName, sn, name, SamAccountName, UserPrincipalname, mail, displayname, distinguishedname, enabled, Lastlogontimestamp | select  GivenName, sn, name, SamAccountName, UserPrincipalname, mail, displayname, enabled, distinguishedname , @{N='LastLogonTimestamp'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}}|export-csv .\documents\SRHGesamt01.12.21.csv
Get-ADUser -server SVGRADC22.kliniken.srh.de -Filter * -SearchBase "DC=Kliniken,DC=srh,DC=de"  -properties GivenName, sn, name, SamAccountName, UserPrincipalname, mail, displayname, distinguishedname, enabled, Lastlogontimestamp | select  GivenName, sn, name, SamAccountName, UserPrincipalname, mail, displayname, enabled, distinguishedname , @{N='LastLogonTimestamp'; E={[DateTime]::FromFileTime($_.LastLogonTimestamp)}}|export-csv .\documents\KlinikenGesamt01.12.21.csv




+++ Tägliches Reporting +++

SRHK Rechner
$date = '07.01.2021'  
(Get-ADComputer -server SVHD-DC12.srhk.srh.de -Filter * -SearchBase "OU=Clients,OU=Tier2,OU=SRHK,DC=srhk,DC=srh,DC=de" -properties name, Lastlogondate | Where-Object {$_.LastLogonDate -ge $date}|select name, lastlogondate).count
(Get-ADComputer -server SVHD-DC12.srhk.srh.de -Filter {(Enabled -eq $True)}  -SearchBase "OU=Clients,OU=Tier2,OU=SRHK,DC=srhk,DC=srh,DC=de" -properties name, Lastlogondate | Where-Object {$_.LastLogonDate -ge $date}|select name, lastlogondate).count

(Get-ADComputer -server SVHD-DC12.srhk.srh.de -Filter {(Enabled -eq $True) -and ((Name -like "SHS*") -or (Name -like "VLS*") -or (Name -like "bbwn*"))}  -SearchBase "OU=Clients,OU=Tier2,OU=SRHK,DC=srhk,DC=srh,DC=de" -properties name, Lastlogondate | Where-Object {$_.LastLogonDate -ge $date}|select name, lastlogondate).count




























get-ADUser -server SVHD-DC34.edu.srh.de -Filter * -SearchBase "OU=Postfaecher,OU=SRHSchulenGmbH,OU=_Schulen,DC=edu,DC=srh,DC=de" -properties distinguishedname, name | select name distinguishedname >.\documents\Homedirectory.txt

Tägliches Monitoring
Get-ADComputer -server SVHD-DC34.edu.srh.de -Filter * -Searchbase "OU=Clients,OU=Tier2,OU=SRH,DC=EDU,DC=SRH,DC=de" properties name, enabled, distinguishedname, LastLogonTimeStamp

Get-EventLog -List
Get-EventLog -LogName System -Newest 100 -EntryType error
Get-EventLog -LogName System -ComputerName Server01, Server02, Server03
Get-EventLog -LogName System -EntryType Error -After '15/11/2021 15:00:00' -Before '18/11/2021 10:00:00'


Get-Host
Get-Process

Get-Command -Module 
Get-help

Get-Command New-ADUser -Syntax

$PASSWORD= ConvertTo-SecureString –AsPlainText -Force -String kamisama123@@
New-LocalUser -Name "gohan" -Description "Son of Goku" -Password $PASSWORD